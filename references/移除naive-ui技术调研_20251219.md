# 移除naive-ui技术调研与迁移方案

## 一、项目中naive-ui使用现状分析

### 1. 全局配置与依赖
- **依赖版本**: naive-ui@^2.38.0
- **全局配置文件**: `/Users/frustigor/dev/@fgu/fgu/opensource/webcut/src/views/provider/index.vue`
  - NConfigProvider（主题、locale、日期locale配置）
  - NLoadingBarProvider
  - NModalProvider
  - NDialogProvider
  - NMessageProvider
  - NNotificationProvider

### 2. 组件使用情况
通过代码扫描，项目中使用了以下naive-ui组件：

#### 表单组件
- `NForm`、`NFormItem`：用于表单布局和验证
- `NInput`、`NInputNumber`：输入框和数字输入
- `NInputGroup`：输入组组件
- `NSelect`：下拉选择器
- `NSwitch`：开关组件
- `NRadioGroup`、`NRadioButton`：单选按钮组
- `NColorPicker`：颜色选择器
- `NSlider`：滑块组件

#### 布局与展示
- `NSplit`：分割面板布局
- `NDivider`：分割线
- `NAlert`：提示框
- `NSpin`：加载动画

#### 交互组件
- `NButton`：按钮组件
- `NIcon`：图标组件
- `NDropdown`：下拉菜单
- `NUpload`、`NUploadDragger`：文件上传

#### 弹窗与通知
- `NModal`：模态框
- `NMessage`：消息提示（通过useMessage）
- `NNotification`：通知组件

### 3. 插件与钩子使用
- `useMessage`：消息提示插件（在`src/components/system-fonts/index.vue`中使用）

## 二、替代方案调研

### 国内方案

#### 1. Element Plus（推荐）
**特点**：
- 由饿了么团队维护，Vue生态中最成熟的UI库之一
- 110+组件，覆盖所有naive-ui使用场景
- 支持TypeScript，API设计友好
- 文档完善，社区活跃
- 采用CSS变量实现主题定制
- **不使用CSS-in-JS，采用传统CSS文件模式**

**适配难度**：
- 组件命名和API与naive-ui差异较大，需要逐个替换
- 表单验证逻辑需要调整
- 主题系统需要重新配置

#### 2. Arco Design Vue
**特点**：
- 字节跳动出品，设计风格现代
- 130+组件，功能丰富
- 支持暗黑模式和主题定制
- 性能优化较好
- **不使用CSS-in-JS，采用传统CSS文件模式**

**适配难度**：
- 组件API与naive-ui差异较大
- 部分组件（如颜色选择器）功能不同
- 需要重新设计主题配置

#### 3. Ant Design Vue
**特点**：
- 蚂蚁金服出品，企业级设计语言
- 130+组件，功能全面
- 国际化支持好
- 文档完善
- **不使用CSS-in-JS，采用传统CSS文件模式**

**适配难度**：
- 组件API与naive-ui差异较大
- 表单验证逻辑完全不同
- 主题系统配置复杂

### 海外方案

#### 1. Vuetify（推荐）
**特点**：
- 基于Material Design规范，设计风格现代统一
- 100+组件，功能全面，覆盖所有naive-ui使用场景
- 支持TypeScript，API设计简洁
- 文档完善，社区活跃（GitHub Star约38.4k）
- 响应式设计，支持多设备适配
- 主题定制灵活，支持CSS变量
- **不使用CSS-in-JS，采用传统CSS文件模式**

**适配难度**：
- 组件命名和API与naive-ui差异较大
- 表单验证逻辑不同，需要重新实现
- 主题系统配置方式不同
- 学习曲线较陡

#### 2. PrimeVue
**特点**：
- 由PrimeTek公司开发，企业级UI组件库
- 100+组件，功能丰富
- 支持TypeScript，API设计友好
- 文档完善，社区活跃
- 支持多种主题，包括Material Design和Bootstrap
- 性能优化较好
- **不使用CSS-in-JS，采用传统CSS文件模式**

**适配难度**：
- 组件API与naive-ui差异较大
- 表单验证逻辑不同
- 主题系统需要重新配置

#### 3. Quasar
**特点**：
- 全栈框架，不仅提供UI组件，还包含开发工具链
- 100+组件，功能全面
- 支持TypeScript，API设计友好
- 文档完善，社区活跃
- 支持多平台开发（Web、移动端、桌面端）
- 性能优化较好
- **不使用CSS-in-JS，采用传统CSS文件模式**

**适配难度**：
- 组件API与naive-ui差异较大
- 表单验证逻辑不同
- 主题系统需要重新配置
- 学习曲线较陡

#### 4. Bootstrap Vue
**特点**：
- 基于Bootstrap框架，设计风格经典
- 100+组件，功能全面
- 支持TypeScript，API设计友好
- 文档完善，社区活跃
- 响应式设计，支持多设备适配
- **不使用CSS-in-JS，采用传统CSS文件模式**

**适配难度**：
- 组件API与naive-ui差异较大
- 表单验证逻辑不同
- 主题系统需要重新配置

### 5. 自定义组件（不推荐）
**特点**：
- 完全自定义，无第三方依赖
- 灵活性最高
- 开发成本高，维护难度大

**适配难度**：
- 需要从零实现所有组件
- 开发周期长
- 缺乏统一设计语言

## 三、迁移计划与步骤

### 阶段1：准备工作（1-2天）
1. 安装目标UI框架（推荐Element Plus）
   ```bash
   npm install element-plus
   ```
2. 配置全局主题和样式
3. 移除naive-ui依赖
   ```bash
   npm uninstall naive-ui
   ```

### 阶段2：全局配置迁移（1天）
1. 替换`src/views/provider/index.vue`中的全局配置
   - 替换NConfigProvider为Element Plus的ConfigProvider
   - 替换各个Provider组件
   - 配置主题和locale

### 阶段3：组件替换（3-5天）
按组件类型逐个替换：

#### 表单组件替换
- `NForm` → `ElForm`
- `NFormItem` → `ElFormItem`
- `NInput` → `ElInput`
- `NInputNumber` → `ElInputNumber`
- `NSelect` → `ElSelect`
- `NSwitch` → `ElSwitch`
- `NRadioGroup` → `ElRadioGroup`
- `NRadioButton` → `ElRadioButton`
- `NColorPicker` → `ElColorPicker`
- `NSlider` → `ElSlider`

#### 布局组件替换
- `NSplit` → `ElSplitPane`（需要额外安装）
- `NDivider` → `ElDivider`
- `NAlert` → `ElAlert`
- `NSpin` → `ElLoading`

#### 交互组件替换
- `NButton` → `ElButton`
- `NIcon` → `ElIcon`
- `NDropdown` → `ElDropdown`
- `NUpload` → `ElUpload`

#### 弹窗组件替换
- `NModal` → `ElDialog`
- `NMessage` → `ElMessage`
- `NNotification` → `ElNotification`

### 阶段4：测试与调试（2-3天）
1. 功能测试：确保所有组件正常工作
2. 样式调整：修复布局和样式问题
3. 性能测试：检查页面加载速度
4. 兼容性测试：确保在不同浏览器中正常显示

### 阶段5：优化与收尾（1天）
1. 清理无用代码和依赖
2. 优化组件性能
3. 编写迁移文档

## 四、风险评估与应对

### 1. 时间风险
- 迁移工作量较大，预计需要1-2周时间
- 应对：分阶段迁移，优先替换核心组件

### 2. 技术风险
- 部分组件功能差异较大，需要重新实现
- 应对：提前调研组件差异，制定适配方案

### 3. 样式风险
- 新UI框架的设计风格与原有设计可能存在差异
- 应对：统一设计规范，调整主题配置

## 五、推荐方案

### 国内方案推荐
**推荐使用Element Plus作为替代方案**，理由如下：
1. 社区成熟，文档完善，遇到问题容易解决
2. 组件覆盖全面，能够满足项目所有需求
3. 性能优化较好，不会影响页面加载速度
4. 主题定制灵活，能够匹配原有设计风格
5. **不使用CSS-in-JS，采用传统CSS文件模式**

### 海外方案推荐
**推荐使用Vuetify作为替代方案**，理由如下：
1. 基于Material Design规范，设计风格现代统一
2. 社区活跃，文档完善，GitHub Star数约38.4k
3. 组件覆盖全面，能够满足项目所有需求
4. 性能优化较好，响应式设计支持多设备适配
5. 主题定制灵活，支持CSS变量
6. **不使用CSS-in-JS，采用传统CSS文件模式**

## 六、Vuetify详细实施步骤

### 阶段1：准备工作（1天）

#### 1. 安装Vuetify
```bash
npm install vuetify@next
```

#### 2. 配置Vuetify
创建`src/plugins/vuetify.ts`文件：
```typescript
import 'vuetify/styles'
import { createVuetify } from 'vuetify'
import * as components from 'vuetify/components'
import * as directives from 'vuetify/directives'

export default createVuetify({
  components,
  directives,
  theme: {
    defaultTheme: 'light',
    themes: {
      light: {
        colors: {
          primary: '#1976D2',
          secondary: '#424242',
          accent: '#82B1FF',
          error: '#FF5252',
          info: '#2196F3',
          success: '#4CAF50',
          warning: '#FFC107',
        },
      },
    },
  },
})
```

#### 3. 全局注册Vuetify
修改`src/main.ts`文件：
```typescript
import { createApp } from 'vue'
import App from './App.vue'
import vuetify from './plugins/vuetify'

const app = createApp(App)
app.use(vuetify)
app.mount('#app')
```

### 阶段2：全局配置替换（1天）

#### 1. 替换全局配置文件
修改`src/views/provider/index.vue`：

**原naive-ui配置：**
```vue
<template>
  <n-config-provider :theme="theme" :theme-overrides="overrides" :locale="lngPkg" :date-locale="dateLngPkg" v-else>
    <n-loading-bar-provider>
      <n-modal-provider>
        <n-dialog-provider>
          <n-message-provider>
            <n-element>
              <n-notification-provider placement="bottom-right">
                <theme-box class="webcut-container">
                  <slot></slot>
                </theme-box>
              </n-notification-provider>
            </n-element>
          </n-message-provider>
        </n-dialog-provider>
      </n-modal-provider>
    </n-loading-bar-provider>
  </n-config-provider>
</template>
```

**替换为Vuetify配置：**
```vue
<template>
  <v-app>
    <v-main>
      <theme-box class="webcut-container">
        <slot></slot>
      </theme-box>
    </v-main>
  </v-app>
</template>
```

### 阶段3：组件替换（3-5天）

#### 1. 表单组件替换

**NForm → VForm**
```vue
<!-- 原naive-ui -->
<n-form size="small" label-placement="left" :label-width="90" label-align="right" class="webcut-form webcut-panel-form">
  <!-- 表单内容 -->
</n-form>

<!-- 替换为Vuetify -->
<v-form ref="form" class="webcut-form webcut-panel-form">
  <!-- 表单内容 -->
</v-form>
```

**NFormItem → VTextField/VSelect等**
```vue
<!-- 原naive-ui -->
<n-form-item :label="t('文本')" class="n-form-item--flex-column">
  <n-input type="textarea" v-model:value="text"></n-input>
</n-form-item>

<!-- 替换为Vuetify -->
<v-textarea v-model="text" label="{{ t('文本') }}"></v-textarea>
```

**NInput → VTextField**
```vue
<!-- 原naive-ui -->
<n-input v-model:value="text"></n-input>

<!-- 替换为Vuetify -->
<v-text-field v-model="text"></v-text-field>
```

**NInputNumber → VNumberInput**
```vue
<!-- 原naive-ui -->
<n-input-number v-model:value="cssData['font-size']" :min="1" :max="300"></n-input-number>

<!-- 替换为Vuetify -->
<v-number-input v-model="cssData['font-size']" :min="1" :max="300"></v-number-input>
```

**NColorPicker → VColorPicker**
```vue
<!-- 原naive-ui -->
<n-color-picker v-model:value="cssData.color" default-value="rgba(255,255,255,1)" :modes="['rgb']"></n-color-picker>

<!-- 替换为Vuetify -->
<v-color-picker v-model="cssData.color"></v-color-picker>
```

**NSwitch → VSwitch**
```vue
<!-- 原naive-ui -->
<n-switch v-model:value="cssData['text-transform']" checked-value="uppercase" unchecked-value="none" />

<!-- 替换为Vuetify -->
<v-switch v-model="cssData['text-transform']" true-value="uppercase" false-value="none" />
```

**NRadioGroup → VRadioGroup**
```vue
<!-- 原naive-ui -->
<n-radio-group v-model:value="cssData['text-align']">
  <n-radio-button v-for="option in Object.keys(AlignIcons)" :key="option" :value="option">
    <n-icon :component="AlignIcons[option]"></n-icon>
  </n-radio-button>
</n-radio-group>

<!-- 替换为Vuetify -->
<v-radio-group v-model="cssData['text-align']">
  <v-radio v-for="option in Object.keys(AlignIcons)" :key="option" :value="option">
    <v-icon>{{ AlignIcons[option] }}</v-icon>
  </v-radio>
</v-radio-group>
```

#### 2. 布局组件替换

**NSplit → VSplitter**
```vue
<!-- 原naive-ui -->
<n-split v-model:value="splitValue" mode="vertical">
  <template #first>
    <!-- 左侧内容 -->
  </template>
  <template #second>
    <!-- 右侧内容 -->
  </template>
</n-split>

<!-- 替换为Vuetify -->
<v-splitter v-model="splitValue" direction="horizontal">
  <template #before>
    <!-- 左侧内容 -->
  </template>
  <template #after>
    <!-- 右侧内容 -->
  </template>
</v-splitter>
```

**NDivider → VDivider**
```vue
<!-- 原naive-ui -->
<n-divider></n-divider>

<!-- 替换为Vuetify -->
<v-divider></v-divider>
```

**NAlert → VAlert**
```vue
<!-- 原naive-ui -->
<n-alert class="webcut-message" v-if="!currentSource" type="warning">{{ t('请先选择音频片段') }}</n-alert>

<!-- 替换为Vuetify -->
<v-alert class="webcut-message" v-if="!currentSource" type="warning">{{ t('请先选择音频片段') }}</v-alert>
```

#### 3. 交互组件替换

**NButton → VBtn**
```vue
<!-- 原naive-ui -->
<n-button type="default" tertiary @click="handleSetVerticalBottom">{{ t('紧贴底边') }}</n-button>

<!-- 替换为Vuetify -->
<v-btn variant="outlined" @click="handleSetVerticalBottom">{{ t('紧贴底边') }}</v-btn>
```

**NIcon → VIcon**
```vue
<!-- 原naive-ui -->
<n-icon :component="AlignIcons[option]"></n-icon>

<!-- 替换为Vuetify -->
<v-icon>{{ AlignIcons[option] }}</v-icon>
```

**NDropdown → VMenu**
```vue
<!-- 原naive-ui -->
<n-dropdown trigger="hover">
  <template #trigger>
    <n-button>菜单</n-button>
  </template>
  <template #option>
    <n-dropdown-item>选项1</n-dropdown-item>
    <n-dropdown-item>选项2</n-dropdown-item>
  </template>
</n-dropdown>

<!-- 替换为Vuetify -->
<v-menu>
  <template #activator="{ props }">
    <v-btn v-bind="props">菜单</v-btn>
  </template>
  <v-list>
    <v-list-item title="选项1"></v-list-item>
    <v-list-item title="选项2"></v-list-item>
  </v-list>
</v-menu>
```

**NUpload → VFileInput**
```vue
<!-- 原naive-ui -->
<n-upload @before-upload="handleUpload">
  <n-button>上传文件</n-button>
</n-upload>

<!-- 替换为Vuetify -->
<v-file-input label="上传文件" @change="handleUpload"></v-file-input>
```

#### 4. 弹窗组件替换

**NModal → VDialog**
```vue
<!-- 原naive-ui -->
<n-modal v-model:show="modalVisible">
  <div class="modal-content">
    <!-- 弹窗内容 -->
  </div>
</n-modal>

<!-- 替换为Vuetify -->
<v-dialog v-model="modalVisible" max-width="500px">
  <v-card>
    <v-card-title>弹窗标题</v-card-title>
    <v-card-text>
      <!-- 弹窗内容 -->
    </v-card-text>
    <v-card-actions>
      <v-btn @click="modalVisible = false">取消</v-btn>
      <v-btn @click="handleConfirm">确认</v-btn>
    </v-card-actions>
  </v-card>
</v-dialog>
```

**NMessage → useToast**
```vue
<!-- 原naive-ui -->
import { useMessage } from 'naive-ui'
const message = useMessage()
message.success('操作成功')

<!-- 替换为Vuetify -->
import { useToast } from 'vuetify'
const toast = useToast()
toast.show({
  text: '操作成功',
  color: 'success',
  duration: 3000,
})
```

### 阶段4：测试与调试（2-3天）

#### 1. 功能测试
- 确保所有组件正常工作
- 测试表单验证逻辑
- 测试弹窗和通知功能

#### 2. 样式调整
- 修复布局和样式问题
- 调整主题颜色匹配原有设计
- 优化响应式布局

#### 3. 性能测试
- 检查页面加载速度
- 优化组件渲染性能

### 阶段5：优化与收尾（1天）

#### 1. 清理无用代码
- 移除naive-ui相关的import语句
- 删除无用的主题配置文件

#### 2. 优化组件性能
- 使用v-memo优化组件渲染
- 实现虚拟滚动优化长列表

#### 3. 编写迁移文档
- 记录迁移过程中遇到的问题和解决方案
- 编写新组件的使用文档

### 阶段6：移除naive-ui（1天）

#### 1. 卸载naive-ui
```bash
npm uninstall naive-ui
```

#### 2. 清理残留代码
- 移除所有naive-ui相关的import语句
- 删除naive-ui的全局配置文件

## 七、风险评估与应对

### 1. 时间风险
- 迁移工作量较大，预计需要1-2周时间
- 应对：分阶段迁移，优先替换核心组件

### 2. 技术风险
- 部分组件功能差异较大，需要重新实现
- 应对：提前调研组件差异，制定适配方案

### 3. 样式风险
- Vuetify的设计风格与原有设计可能存在差异
- 应对：统一设计规范，调整主题配置

## 八、总结

通过以上详细的实施步骤，您可以顺利将项目从naive-ui迁移到Vuetify。迁移过程中需要注意保持代码质量和用户体验的一致性，同时进行充分的测试和调试。

## 六、总结
移除naive-ui需要进行全面的组件替换和配置调整，预计需要1-2周时间。选择合适的替代方案（如Element Plus）可以降低迁移难度和风险。在迁移过程中，需要注意保持代码质量和用户体验的一致性。